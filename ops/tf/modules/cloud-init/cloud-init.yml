#cloud-config

write_files:
  - path: /etc/config.yaml
    encoding: b64
    owner: root:root
    permissions: "0600"
    content: |
      ${bacalhau_config_file}

  - path: /etc/systemd/system/bacalhau.service
    encoding: b64
    owner: root:root
    permissions: "0600"
    content: |
      ${bacalhau_service_file}

runcmd:
  #
  # Setup Bacalhau Repo
  #
  - mkdir /data
  - chmod 0700 /data
  - mv /etc/config.yaml /data/config.yaml
  - sudo systemctl daemon-reload
  - sudo systemctl enable docker
  - sudo systemctl restart docker
  - sudo systemctl enable bacalhau.service
  - sudo systemctl restart bacalhau.service


