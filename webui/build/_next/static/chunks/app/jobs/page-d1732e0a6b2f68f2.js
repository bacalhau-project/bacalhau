(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{13319:function(e,s,t){Promise.resolve().then(t.bind(t,14593))},14593:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eE}});var l=t(57437),a=t(2265),n=t(99376),r=t(27648),i=t(73578),c=t(9127),o=t(35974),d=t(47050),x=t(40308),u=e=>{let{status:s}=e,t=(0,x.wg)(s),a=(0,x.AC)(t),n=(e=>{switch(e){case d.Xv.JobStateTypeUndefined:return"bg-gray-100 text-gray-800";case d.Xv.JobStateTypePending:return"bg-yellow-100 text-yellow-800";case d.Xv.JobStateTypeQueued:return"bg-blue-100 text-blue-800";case d.Xv.JobStateTypeRunning:return"bg-purple-100 text-purple-800";case d.Xv.JobStateTypeCompleted:return"bg-green-100 text-green-800";case d.Xv.JobStateTypeFailed:return"bg-red-100 text-red-800";case d.Xv.JobStateTypeStopped:return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(t);return(0,l.jsx)(o.C,{className:"text-xs ".concat(n),children:a})},h=t(14822),j=t(93947);let m=e=>{let{className:s}=e;return(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","aria-label":"Docker",role:"img",viewBox:"0 0 512 512",width:"24px",height:"24px",fill:"none",children:[(0,l.jsx)("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),(0,l.jsx)("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),(0,l.jsxs)("g",{id:"SVGRepo_iconCarrier",children:[(0,l.jsx)("rect",{width:"512",height:"512",rx:"15%",fill:"#ffffff"}),(0,l.jsx)("path",{stroke:"#066da5","stroke-width":"38",d:"M296 226h42m-92 0h42m-91 0h42m-91 0h41m-91 0h42m8-46h41m8 0h42m7 0h42m-42-46h42"}),(0,l.jsx)("path",{fill:"#066da5",d:"m472 228s-18-17-55-11c-4-29-35-46-35-46s-29 35-8 74c-6 3-16 7-31 7H68c-5 19-5 145 133 145 99 0 173-46 208-130 52 4 63-39 63-39"})]})]})};var p=e=>{var s,t;let{job:a}=e,n=(null===(t=a.Tasks)||void 0===t?void 0:null===(s=t[0].Engine)||void 0===s?void 0:s.Type)||"unknown";return(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e.toLowerCase()){case"docker":return(0,l.jsx)(m,{className:"w-5 h-5 text-blue-500"});case"wasm":return(0,l.jsx)(h.Z,{className:"w-5 h-5 text-green-500"});default:return(0,l.jsx)(j.Z,{className:"w-5 h-5 text-gray-500"})}})(n),(0,l.jsx)("span",{className:"text-sm font-medium",children:n})]})},v=t(62869),b=t(53647),f=t(93940);function g(e){let{jobs:s=[],pageSize:t,setPageSize:a,pageIndex:n,onPreviousPage:o,onNextPage:d,hasNextPage:h}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.iA,{children:[(0,l.jsx)(i.xD,{className:"bg-muted/50",children:(0,l.jsxs)(i.SC,{children:[(0,l.jsx)(i.ss,{className:"p-3 w-80",children:"ID"}),(0,l.jsx)(i.ss,{className:"w-32",children:"Status"}),(0,l.jsx)(i.ss,{className:"w-40",children:"Created At"}),(0,l.jsx)(i.ss,{className:"w-28",children:"Run Time"}),(0,l.jsx)(i.ss,{className:"w-80",children:"Message"}),(0,l.jsx)(i.ss,{className:"w-28",children:"Engine"}),(0,l.jsx)(i.ss,{className:"w-28",children:"Type"})]})}),(0,l.jsx)(i.RM,{children:s.map(e=>{var s,t;return(0,l.jsxs)(i.SC,{children:[(0,l.jsx)(i.pj,{className:"p-3",children:(0,l.jsx)(r.default,{href:"/jobs?id=".concat(e.ID),children:(0,l.jsx)(c.Z,{text:e.Name,maxLength:25})})}),(0,l.jsx)(i.pj,{children:(0,l.jsx)(u,{status:null===(s=e.State)||void 0===s?void 0:s.StateType})}),(0,l.jsx)(i.pj,{children:(0,f.i$)(e.CreateTime)}),(0,l.jsx)(i.pj,{children:(0,x.PO)(e)}),(0,l.jsx)(i.pj,{children:(0,l.jsx)(c.Z,{text:null===(t=e.State)||void 0===t?void 0:t.Message,maxLength:50})}),(0,l.jsx)(i.pj,{children:(0,l.jsx)(p,{job:e})}),(0,l.jsx)(i.pj,{children:e.Type})]},e.ID)})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between space-x-2 py-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Jobs per page"}),(0,l.jsxs)(b.Ph,{value:"".concat(t),onValueChange:e=>a(Number(e)),children:[(0,l.jsx)(b.i4,{className:"h-8 w-[70px]",children:(0,l.jsx)(b.ki,{placeholder:t})}),(0,l.jsx)(b.Bw,{side:"top",children:[10,20,30,40,50].map(e=>(0,l.jsx)(b.Ql,{value:"".concat(e),children:e},e))})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(v.z,{variant:"outline",size:"sm",onClick:o,disabled:0===n,children:"Previous"}),(0,l.jsx)(v.z,{variant:"outline",size:"sm",onClick:d,disabled:!h,children:"Next"})]})]})]})}var N=t(95186),y=t(59581),w=t(89338),S=t(82431);function k(){let[e,s]=(0,a.useState)([]),[t,n]=(0,a.useState)(""),{isInitialized:r}=(0,y.h)(),[i,c]=(0,a.useState)(10),[o,x]=(0,a.useState)(0),[u,h]=(0,a.useState)([void 0]),[j,m]=(0,a.useState)(!1),p=(0,a.useCallback)(async()=>{if(r)try{var e;let t=await d.pO.listJobs({query:{limit:i,next_token:u[o],reverse:!0},throwOnError:!0});s(null!==(e=t.data.Items)&&void 0!==e?e:[]),t.data.NextToken&&o===u.length-1&&h([...u,t.data.NextToken])}catch(e){console.error("Error fetching jobs:",e),s([])}},[r,i,o,u]);(0,a.useEffect)(()=>{p()},[p]);let b=(0,a.useCallback)(()=>{m(!0),x(0),h([void 0]),p().then(()=>{setTimeout(()=>m(!1),1e3)})},[p]);(0,w.G)("jobs",b);let f=e.filter(e=>{var s,l,a,n;return null!==(a=null===(s=e.ID)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase()))&&void 0!==a&&a||null!==(n=null===(l=e.Name)||void 0===l?void 0:l.toLowerCase().includes(t.toLowerCase()))&&void 0!==n&&n});return(0,l.jsxs)("div",{className:"container mx-auto",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Jobs"}),(0,l.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(N.I,{className:"w-80",type:"search",value:t,onChange:e=>n(e.target.value),placeholder:"Filter jobs..."}),(0,l.jsx)(v.z,{onClick:b,disabled:j,variant:"outline",size:"icon","aria-label":"Refresh jobs",children:(0,l.jsx)(S.Z,{className:"h-4 w-4"})})]})}),(0,l.jsx)(g,{jobs:f,pageSize:i,setPageSize:e=>{c(e),x(0),h([void 0])},pageIndex:o,onPreviousPage:()=>{o>0&&x(o-1)},onNextPage:()=>{o<u.length-1&&x(o+1)},hasNextPage:o<u.length-1})]})}var C=t(66070),T=t(41351),E=t(34577);let I=e=>{var s,t,a,n,r;let{job:i}=e;return(0,l.jsx)(C.Zb,{className:"mb-4",children:(0,l.jsxs)(C.aY,{className:"py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(E.Z,{label:"Name",children:i.Name}),(0,l.jsx)(E.Z,{label:"ID",children:i.ID}),(0,l.jsx)(E.Z,{label:"Namespace",children:i.Namespace}),(0,l.jsx)(E.Z,{label:"Type",children:i.Type}),(0,l.jsx)(E.Z,{label:"State",children:(0,l.jsx)(u,{status:null===(s=i.State)||void 0===s?void 0:s.StateType})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(E.Z,{label:"Created",children:(0,f.i$)(i.CreateTime,!0)}),(0,l.jsx)(E.Z,{label:"Modified",children:(0,f.i$)(i.ModifyTime,!0)}),(0,l.jsx)(E.Z,{label:"Run Time",children:(0,x.PO)(i)}),(0,l.jsx)(E.Z,{label:"Engine",children:(0,l.jsx)(p,{job:i})}),i.Labels&&Object.keys(i.Labels).length>0&&(0,l.jsx)(E.Z,{label:"Labels",children:(0,l.jsx)(T.Z,{labels:i.Labels})}),(null===(n=i.Tasks)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:null===(t=a.Publisher)||void 0===t?void 0:t.Type)&&(0,l.jsx)(E.Z,{label:"Publisher",children:i.Tasks[0].Publisher.Type})]})]}),(null===(r=i.State)||void 0===r?void 0:r.Message)&&(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)(E.Z,{label:"Message",children:i.State.Message})})]})})};var D=t(61641),Z=t(65613),P=t(90277),z=t(94508);let R=P.fC,L=P.xz,O=P.h_,J=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(P.aV,{className:(0,z.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s})});J.displayName=P.aV.displayName;let M=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsxs)(O,{children:[(0,l.jsx)(J,{}),(0,l.jsx)(P.VY,{ref:s,className:(0,z.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]})});M.displayName=P.VY.displayName;let U=e=>{let{className:s,...t}=e;return(0,l.jsx)("div",{className:(0,z.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};U.displayName="AlertDialogHeader";let _=e=>{let{className:s,...t}=e;return(0,l.jsx)("div",{className:(0,z.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};_.displayName="AlertDialogFooter";let X=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(P.Dx,{ref:s,className:(0,z.cn)("text-lg font-semibold",t),...a})});X.displayName=P.Dx.displayName;let A=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(P.dk,{ref:s,className:(0,z.cn)("text-sm text-muted-foreground",t),...a})});A.displayName=P.dk.displayName;let V=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(P.aU,{ref:s,className:(0,z.cn)((0,v.d)(),t),...a})});V.displayName=P.aU.displayName;let W=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(P.$j,{ref:s,className:(0,z.cn)((0,v.d)({variant:"outline"}),"mt-2 sm:mt-0",t),...a})});W.displayName=P.$j.displayName;var $=e=>{var s;let{job:t,onJobUpdated:n}=e,[r,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null);if(void 0===t.ID)return(0,l.jsxs)(Z.bZ,{variant:"destructive",children:[(0,l.jsx)(Z.Cd,{children:"Error"}),(0,l.jsx)(Z.X,{children:"Job ID is undefined. Cannot perform actions."})]});let u=async()=>{i(!0),o(null);try{await d.pO.stopJob({path:{id:t.ID},query:{reason:"User requested stop"},throwOnError:!0}),n()}catch(e){console.error("Error stopping job:",e),o("Failed to stop the job. Please try again.")}finally{i(!1)}};return(0,l.jsxs)("div",{className:"space-y-4",children:[c&&(0,l.jsxs)(Z.bZ,{variant:"destructive",children:[(0,l.jsx)(Z.Cd,{children:"Error"}),(0,l.jsx)(Z.X,{children:c})]}),(0,l.jsx)("div",{className:"flex space-x-2",children:!(0,x.rc)(null===(s=t.State)||void 0===s?void 0:s.StateType)&&(0,l.jsxs)(R,{children:[(0,l.jsx)(L,{asChild:!0,children:(0,l.jsxs)(v.z,{variant:"destructive",children:[(0,l.jsx)(D.Z,{className:"mr-2 h-4 w-4"}),"Stop Job"]})}),(0,l.jsxs)(M,{children:[(0,l.jsxs)(U,{children:[(0,l.jsx)(X,{children:"Are you sure you want to stop this job?"}),(0,l.jsx)(A,{children:"This action cannot be undone. The job will be stopped and cannot be resumed."})]}),(0,l.jsxs)(_,{children:[(0,l.jsx)(W,{children:"Cancel"}),(0,l.jsx)(V,{onClick:u,disabled:r,children:r?"Stopping...":"Stop Job"})]})]})]})})]})},Y=t(12339),F=t(50721);let q=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(F.fC,{className:(0,z.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,l.jsx)(F.bU,{className:(0,z.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});q.displayName=F.fC.displayName;var H=t(32489),G=t(90740);let Q=["text-blue-800","text-purple-800","text-orange-700","text-pink-700","text-cyan-700","text-yellow-700"],B=(e,s,t)=>{if(!e)return"";if(s[e])return s[e];{let l=Q[t%Q.length];return s[e]=l,l}};var K=e=>{let{history:s,isLoading:t,pageSize:n,pageIndex:r,onPreviousPage:c,onNextPage:o,onPageSizeChange:d,hasNextPage:u}=e,[h,j]=(0,a.useState)({}),[m,p]=(0,a.useState)(""),[g,y]=(0,a.useState)(!1),[w,S]=(0,a.useState)(null),k=(0,a.useMemo)(()=>{var e;return null==s?void 0:null===(e=s.Items)||void 0===e?void 0:e.filter(e=>{var s,t,l,a,n;let r=(null===(s=e.ExecutionID)||void 0===s?void 0:s.toLowerCase().includes(m.toLowerCase()))||(null===(l=e.Event)||void 0===l?void 0:null===(t=l.Topic)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase()))||(null===(n=e.Event)||void 0===n?void 0:null===(a=n.Message)||void 0===a?void 0:a.toLowerCase().includes(m.toLowerCase())),i=!e.ExecutionID,c=!g||i,o=!w||e.ExecutionID===w;return r&&c&&o})},[s,m,g,w]),T=e=>{S(s=>s===e?null:e)},E=0;return(0,l.jsx)(C.Zb,{children:(0,l.jsxs)(C.aY,{className:"pt-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,l.jsx)(N.I,{placeholder:"Search by Execution ID, Topic, or Message",value:m,onChange:e=>p(e.target.value),className:"flex-grow"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[(0,l.jsx)(q,{checked:g,onCheckedChange:y,id:"job-only-switch"}),(0,l.jsx)("label",{htmlFor:"job-only-switch",children:"Job Events Only"})]})]}),(0,l.jsxs)(i.iA,{children:[(0,l.jsx)(i.xD,{children:(0,l.jsxs)(i.SC,{children:[(0,l.jsx)(i.ss,{className:"w-1/6",children:"Time"}),(0,l.jsx)(i.ss,{className:"w-1/6",children:"ExecutionID"}),(0,l.jsx)(i.ss,{className:"w-1/6",children:"Topic"}),(0,l.jsx)(i.ss,{className:"w-2/6",children:"Message"}),(0,l.jsx)(i.ss,{className:"w-1/12",children:"Filter"})]})}),(0,l.jsx)(i.RM,{children:null==k?void 0:k.map((e,s)=>{var t,a;let n=!!e.ExecutionID,r="";return n?(r=B(e.ExecutionID,h,E),E++):r="font-medium",(0,l.jsxs)(i.SC,{className:r,children:[(0,l.jsx)(i.pj,{children:(0,f.mr)(e.Time,!0)}),(0,l.jsx)(i.pj,{children:n?(0,x.$r)(e.ExecutionID):"-"}),(0,l.jsx)(i.pj,{children:null===(t=e.Event)||void 0===t?void 0:t.Topic}),(0,l.jsx)(i.pj,{children:null===(a=e.Event)||void 0===a?void 0:a.Message}),(0,l.jsx)(i.pj,{className:"p-0 w-10",children:n?(0,l.jsx)(v.z,{variant:"ghost",size:"sm",onClick:()=>T(e.ExecutionID),children:w===e.ExecutionID?(0,l.jsx)(H.Z,{size:16}):(0,l.jsx)(G.Z,{size:16})}):(0,l.jsx)("div",{className:"h-10 w-10"})})]},s)})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between space-x-2 py-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Events per page"}),(0,l.jsxs)(b.Ph,{value:"".concat(n),onValueChange:e=>d(Number(e)),children:[(0,l.jsx)(b.i4,{className:"h-8 w-[70px]",children:(0,l.jsx)(b.ki,{placeholder:n})}),(0,l.jsx)(b.Bw,{side:"top",children:[100,200,500,1e3].map(e=>(0,l.jsx)(b.Ql,{value:"".concat(e),children:e},e))})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(v.z,{variant:"outline",size:"sm",onClick:c,disabled:0===r||t,children:"Previous"}),(0,l.jsx)(v.z,{variant:"outline",size:"sm",onClick:o,disabled:!u||t,children:"Next"})]})]})]})})},ee=e=>{let{jobId:s}=e,[t,n]=(0,a.useState)(),[r,i]=(0,a.useState)(100),[c,o]=(0,a.useState)(0),[x,u]=(0,a.useState)([void 0]),[h,j]=(0,a.useState)(!1),m=(0,a.useCallback)(async()=>{j(!0);try{let e=await d.pO.listHistory({path:{id:s},query:{limit:r,next_token:x[c]},throwOnError:!0});n(e.data),e.data.NextToken&&c===x.length-1&&u([...x,e.data.NextToken])}catch(e){console.error("Error fetching job history:",e),n(void 0)}finally{j(!1)}},[s,r,c,x]);return(0,a.useEffect)(()=>{m()},[m]),(0,l.jsx)(K,{history:t,isLoading:h,pageSize:r,pageIndex:c,onPreviousPage:()=>{c>0&&o(c-1)},onNextPage:()=>{c<x.length-1&&o(c+1)},onPageSizeChange:e=>{i(e),o(0),u([void 0])},hasNextPage:c<x.length-1})},es=t(92735),et=t(61312),el=t(35153);let ea=["local","s3"],en=[d.Xv.JobStateTypeCompleted,d.Xv.JobStateTypeFailed,d.Xv.JobStateTypeStopped],er=e=>{let{publisherType:s,publishedResult:t,isTaskCompleted:a,onDownload:n}=e,r=ea.includes(s),i="";return(s?a?(null==t?void 0:t.Params)?r||(i="Not supported for this publisher"):i="No results published":i="Task still running":i="No publisher specified",i)?(0,l.jsx)(et.zt,{children:(0,l.jsxs)(et.fC,{children:[(0,l.jsx)(et.xz,{asChild:!0,children:(0,l.jsx)("button",{className:"p-2 text-gray-300",disabled:!0,children:(0,l.jsx)(es.Z,{size:18,strokeWidth:2})})}),(0,l.jsx)(et.h_,{children:(0,l.jsxs)(et.VY,{className:"px-3 py-2 text-sm text-white bg-gray-900 rounded-md shadow-lg",sideOffset:5,children:[i,(0,l.jsx)(et.Eh,{className:"fill-current text-gray-900"})]})})]})}):(0,l.jsx)("button",{className:"p-2 text-black transition-colors duration-150 hover:text-blue-500 active:text-blue-700",onClick:()=>n(t),children:(0,l.jsx)(es.Z,{size:18,strokeWidth:2})})},ei=()=>{(0,el.Am)({variant:"destructive",title:"No results found for this job",description:"You can check the logged output of the job in the logs tab."})},ec=e=>{try{return new URL(e),!0}catch(e){return!1}},eo=e=>{if(!ec(e)){(0,el.Am)({variant:"destructive",title:"Invalid download URL",description:"The download URL appears to be invalid."});return}window.open(e,"_blank")||(0,el.Am)({variant:"destructive",title:"Download blocked",description:"Please allow popups for this site to download results."})},ed=e=>({async download(s){let t=s.Params,l=null==t?void 0:t[e];l?eo(l):ei()}}),ex=e=>"s3"===e?ed("PreSignedURL"):ed("URL");var eu=e=>{var s;let{executions:t,tasks:n,state:r}=e,c=(0,x.wg)(null==r?void 0:r.StateType),o=!!c&&en.includes(c),d=(0,a.useMemo)(()=>{var e,s,t;return null!==(t=null===(s=n[0])||void 0===s?void 0:null===(e=s.Publisher)||void 0===e?void 0:e.Type)&&void 0!==t?t:"UNKNOWN"},[n]),u=async e=>{if(!e){ei();return}let s=ex(d);await s.download(e)};return(0,l.jsx)(C.Zb,{children:(0,l.jsx)(C.aY,{className:"pt-6",children:(0,l.jsxs)(i.iA,{children:[(0,l.jsx)(i.xD,{children:(0,l.jsxs)(i.SC,{children:[(0,l.jsx)(i.ss,{children:"Created Time"}),(0,l.jsx)(i.ss,{children:"Modified Time"}),(0,l.jsx)(i.ss,{children:"ID"}),(0,l.jsx)(i.ss,{children:"Node ID"}),(0,l.jsx)(i.ss,{children:"State"}),(0,l.jsx)(i.ss,{children:"Desired State"}),(0,l.jsx)(i.ss,{children:"Results"})]})}),(0,l.jsx)(i.RM,{children:null==t?void 0:null===(s=t.Items)||void 0===s?void 0:s.map(e=>{var s,t;return(0,l.jsxs)(i.SC,{children:[(0,l.jsx)(i.pj,{children:(0,f.i$)(e.CreateTime,!0)}),(0,l.jsx)(i.pj,{children:(0,f.i$)(e.ModifyTime,!0)}),(0,l.jsx)(i.pj,{children:(0,x.$r)(e.ID)}),(0,l.jsx)(i.pj,{children:(0,x.$r)(e.NodeID)}),(0,l.jsx)(i.pj,{children:(0,x.ax)(null===(s=e.ComputeState)||void 0===s?void 0:s.StateType)}),(0,l.jsx)(i.pj,{children:(0,x.ql)(null===(t=e.DesiredState)||void 0===t?void 0:t.StateType)}),(0,l.jsx)(i.pj,{children:(0,l.jsx)(er,{publisherType:d,publishedResult:e.PublishedResult,isTaskCompleted:o,onDownload:u})})]},e.ID)})})]})})})},eh=t(86574),ej=t(12658),em=e=>{let{job:s}=e;return(0,l.jsx)(C.Zb,{className:"bg-gray-900 text-white",children:(0,l.jsx)(C.aY,{className:"pt-6",children:(0,l.jsx)(eh.Z,{language:"json",style:ej.Z,customStyle:{backgroundColor:"transparent",padding:"1rem",margin:0,borderRadius:"0.5rem"},children:JSON.stringify(s,null,2)})})})},ep=t(33276),ev=t(49322),eb=t(52636),ef=t(41671),eg=e=>{let{jobId:s}=e,[t,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1),[d,x]=(0,a.useState)(!1),{isInitialized:u}=(0,y.h)(),h=(0,a.useRef)(null),j=(0,a.useRef)(null),m=()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},p=(0,a.useCallback)(()=>{if(!s||!u)return;if(j.current){console.log("WebSocket connection already exists");return}n([]),i(null),x(!1);let e="/api/v1/orchestrator/jobs/".concat(s,"/logs?follow=true");console.log("Attempting to connect to:",e);let t=new WebSocket(e);t.onopen=()=>{console.log("WebSocket connected"),o(!0)},t.onmessage=e=>{try{let s=JSON.parse(e.data);s.value&&s.value.Line?(n(e=>[...e,{type:s.value.Type,content:s.value.Line}]),setTimeout(m,0)):s.Err&&i("Server error: ".concat(s.Err))}catch(s){console.error("Error parsing message:",s),n(s=>[...s,{type:1,content:e.data}]),setTimeout(m,0)}},t.onerror=e=>{console.error("WebSocket error:",e),i("Failed to connect to log stream. Please try again.")},t.onclose=e=>{console.log("WebSocket disconnected:",e),o(!1),x(!0),j.current=null,1e3!==e.code&&i("Connection closed unexpectedly (".concat(e.code,"). Please try reconnecting."))},j.current=t},[s,u]),b=(0,a.useCallback)(()=>{j.current&&(console.log("Closing WebSocket connection"),j.current.close(),j.current=null,o(!1),x(!0))},[]);(0,a.useEffect)(()=>()=>{b()},[b]);let f=()=>{c||p()};return s&&u?(0,l.jsxs)(C.Zb,{className:"bg-gray-900 text-green-400 h-full",children:[(0,l.jsx)(C.Ol,{className:"p-5",children:(0,l.jsxs)(C.ll,{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{children:t.length>0?(0,l.jsx)("span",{}):c?(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{children:"Connected. Waiting for logs..."})}):(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{children:"Click 'Start Streaming' to fetch logs."})})}),c?(0,l.jsxs)(v.z,{onClick:()=>{b()},variant:"destructive",size:"sm",children:[(0,l.jsx)(D.Z,{className:"mr-2 h-4 w-4"}),"Stop Streaming"]}):(0,l.jsxs)(v.z,{onClick:f,variant:"ghost",className:"bg-green-400 text-gray-900",size:"sm",children:[(0,l.jsx)(ep.Z,{className:"mr-2 h-4 w-4"}),t.length>0?"Restart Streaming":"Start Streaming"]})]})}),(0,l.jsxs)(C.aY,{children:[r?(0,l.jsxs)("div",{className:"flex items-center text-red-500 mb-4",children:[(0,l.jsx)(ev.Z,{className:"mr-2 h-4 w-4"}),(0,l.jsx)("span",{children:r}),(0,l.jsxs)(v.z,{onClick:f,variant:"ghost",size:"sm",className:"ml-2",children:[(0,l.jsx)(eb.Z,{className:"mr-2 h-4 w-4"}),"Reconnect"]})]}):null,(0,l.jsxs)("div",{ref:h,className:"h-[400px] overflow-y-auto font-mono text-sm bg-gray-900 p-4 rounded",children:[t.map((e,s)=>(0,l.jsx)("div",{className:"whitespace-pre-wrap break-words ".concat(2===e.type?"text-red-400":"text-green-400"),children:e.content},s)),d&&(0,l.jsxs)("div",{className:"flex text-yellow-400 mt-4",children:[(0,l.jsx)(ef.Z,{className:"mr-2 h-4 w-4"}),(0,l.jsx)("span",{children:"End of log stream"})]})]})]})]}):null},eN=e=>{var s,t;let{job:n,executions:r}=e,[i,c]=(0,a.useState)("history"),o=null!==(t=null==r?void 0:null===(s=r.Items)||void 0===s?void 0:s.length)&&void 0!==t?t:0;return(0,l.jsxs)(Y.mQ,{value:i,onValueChange:c,children:[(0,l.jsxs)(Y.dr,{children:[(0,l.jsx)(Y.SP,{value:"history",children:"History"}),(0,l.jsxs)(Y.SP,{value:"executions",children:["Executions",o>0&&(0,l.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-gray-600 rounded-full",children:o})]}),(0,l.jsx)(Y.SP,{value:"inspect",children:"Inspect"}),(0,l.jsx)(Y.SP,{value:"logs",children:"Logs"})]}),(0,l.jsx)(Y.nU,{value:"history",children:(0,l.jsx)(ee,{jobId:n.ID})}),(0,l.jsx)(Y.nU,{value:"executions",children:n.Tasks&&n.State&&(0,l.jsx)(eu,{executions:r,tasks:n.Tasks,state:n.State})}),(0,l.jsx)(Y.nU,{value:"inspect",children:(0,l.jsx)(em,{job:n})}),(0,l.jsx)(Y.nU,{value:"logs",children:(0,l.jsx)(eg,{jobId:n.ID})})]})},ey=t(52623),ew=t(23289),eS=t(93022);let ek=()=>(0,l.jsxs)("div",{className:"container mx-auto p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)(eS.O,{className:"h-8 w-64"}),(0,l.jsx)(eS.O,{className:"h-10 w-32"})]}),(0,l.jsx)(eS.O,{className:"h-40 w-full mb-4"}),(0,l.jsx)(eS.O,{className:"h-8 w-full mb-2"}),(0,l.jsx)(eS.O,{className:"h-[300px] w-full"})]});var eC=e=>{let{jobId:s}=e,{data:t,isLoading:n,error:r,execute:i}=(0,ey.H)(),c=(0,a.useCallback)(()=>{i(()=>d.pO.getJob({path:{id:s},query:{include:"executions"},throwOnError:!0}).then(e=>e.data))},[i,s]);if((0,a.useEffect)(()=>{c()},[c]),n)return(0,l.jsx)(ek,{});if(r)return(0,l.jsx)(ew.X,{error:r});if(!t||!t.Job)return;let{Job:o,Executions:x}=t;return(0,l.jsxs)("div",{className:"container mx-auto p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:o.Name}),(0,l.jsx)($,{job:o,onJobUpdated:c})]}),(0,l.jsx)(I,{job:o}),(0,l.jsx)(eN,{job:o,executions:x})]})};function eT(){let e=(0,n.useSearchParams)().get("id");return e?(0,l.jsx)(eC,{jobId:e}):(0,l.jsx)(k,{})}function eE(){return(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsx)(eT,{})})}}},function(e){e.O(0,[310,972,293,960,384,407,371,971,117,744],function(){return e(e.s=13319)}),_N_E=e.O()}]);